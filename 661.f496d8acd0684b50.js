"use strict";(self.webpackChunkcoreui_free_angular_admin_template=self.webpackChunkcoreui_free_angular_admin_template||[]).push([[661],{5661:(I,h,o)=>{o.r(h),o.d(h,{AttendanceModule:()=>l});var f=o(6895),u=o(9299),t=o(4650),c=o(7155),T=o(3730),g=o(529),A=o(7185);class i extends T.bQ{constructor(e,a,d,p){super(e,a,d,p),this._http=e,this._router=a,this._toaster=d,this.ATTENDANCE_FILTER_API="/api/warehouse/attendance_records/filter/",this.ATTENDANCE_SET_API="/api/warehouse/attendance_record/"}getAttendanceRecords(){return super.sendRequest(this.ATTENDANCE_FILTER_API,this.GET)}addAttendanceRecord(e){return super.sendRequest(this.ATTENDANCE_SET_API,this.POST,e)}deleteAttendanceRecord(e){return super.sendRequest(this.ATTENDANCE_SET_API,this.DELETE,e)}updateAttendanceRecord(e,a){return super.sendRequest(this.ATTENDANCE_SET_API,this.PUT,a,e)}}i.\u0275fac=function(e){return new(e||i)(t.LFG(g.eN),t.LFG(u.F0),t.LFG(A._W),t.LFG(T.CT,8))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"});var C=o(4039),N=o(7222),_=o(7974);function y(n,e){1&n&&(t.TgZ(0,"th",13),t._uU(1," ID "),t.qZA())}function S(n,e){if(1&n&&(t.TgZ(0,"td",14),t._uU(1),t.qZA()),2&n){const a=e.$implicit;t.xp6(1),t.hij(" ",a.attendance_id," ")}}function Z(n,e){1&n&&(t.TgZ(0,"th",13),t._uU(1," Estudiante "),t.qZA())}function v(n,e){if(1&n&&(t.TgZ(0,"td",14),t._uU(1),t.qZA()),2&n){const a=e.$implicit;t.xp6(1),t.hij(" ",a.studentName," ")}}function b(n,e){1&n&&(t.TgZ(0,"th",13),t._uU(1," Hora de Entrada "),t.qZA())}function x(n,e){if(1&n&&(t.TgZ(0,"td",14),t._uU(1),t.ALo(2,"date"),t.qZA()),2&n){const a=e.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,a.entry_time,"HH:mm yyyy-MM-dd")," ")}}function E(n,e){1&n&&(t.TgZ(0,"th",13),t._uU(1," Estado "),t.qZA())}function D(n,e){if(1&n&&(t.TgZ(0,"td",14),t._uU(1),t.qZA()),2&n){const a=e.$implicit;t.xp6(1),t.hij(" ",a.status," ")}}function R(n,e){1&n&&(t.TgZ(0,"th",13),t._uU(1," Hora de Salida "),t.qZA())}function U(n,e){if(1&n&&(t.TgZ(0,"td",14),t._uU(1),t.ALo(2,"date"),t.qZA()),2&n){const a=e.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,a.exit_time,"HH:mm yyyy-MM-dd")," ")}}function Y(n,e){1&n&&(t.TgZ(0,"th",13),t._uU(1," Turno "),t.qZA())}function P(n,e){if(1&n&&(t.TgZ(0,"td",14),t._uU(1),t.qZA()),2&n){const a=e.$implicit;t.xp6(1),t.hij(" ",a.shift," ")}}function F(n,e){1&n&&t._UZ(0,"tr",15)}function M(n,e){1&n&&t._UZ(0,"tr",16)}const B=function(){return[5,10,20]};class s{constructor(e,a,d,p){this.attendanceService=e,this.globalKeyListenerService=a,this.toastr=d,this.studentService=p,this.attendanceRecords=[],this.displayedColumns=["attendance_id","studentName","entry_time","status","exit_time","shift"],this.scannedDni="",this.students=[],this.dataSource=new c.by([])}ngOnInit(){this.loadStudents(),this.loadAttendanceRecords(),this.listenToDniScans(),this.globalKeyListenerService.dniRegistrationSuccess.subscribe(()=>{this.loadAttendanceRecords()})}loadStudents(){this.studentService.getStudents().subscribe(e=>{this.students=e},e=>{console.error("Error al cargar los estudiantes",e)})}loadAttendanceRecords(){this.attendanceService.getAttendanceRecords().subscribe(e=>{this.attendanceRecords=e;const a=e.map(d=>({...d,studentName:this.getStudentName(d.student)}));this.dataSource.data=a},e=>{console.error("Error al cargar los registros de asistencia",e)})}getStudentName(e){const a=this.students.find(d=>d.student_id===e);return a?a.name:"N/A"}listenToDniScans(){}}s.\u0275fac=function(e){return new(e||s)(t.Y36(i),t.Y36(C.t),t.Y36(A._W),t.Y36(N.V))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-attendance-table"]],decls:23,vars:5,consts:[[1,"mat-elevation-z8"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","attendance_id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","studentName"],["matColumnDef","entry_time"],["matColumnDef","status"],["matColumnDef","exit_time"],["matColumnDef","shift"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","Select page of periodic elements",3,"pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(e,a){1&e&&(t.TgZ(0,"div",0)(1,"table",1),t.ynx(2,2),t.YNc(3,y,2,0,"th",3),t.YNc(4,S,2,1,"td",4),t.BQk(),t.ynx(5,5),t.YNc(6,Z,2,0,"th",3),t.YNc(7,v,2,1,"td",4),t.BQk(),t.ynx(8,6),t.YNc(9,b,2,0,"th",3),t.YNc(10,x,3,4,"td",4),t.BQk(),t.ynx(11,7),t.YNc(12,E,2,0,"th",3),t.YNc(13,D,2,1,"td",4),t.BQk(),t.ynx(14,8),t.YNc(15,R,2,0,"th",3),t.YNc(16,U,3,4,"td",4),t.BQk(),t.ynx(17,9),t.YNc(18,Y,2,0,"th",3),t.YNc(19,P,2,1,"td",4),t.BQk(),t.YNc(20,F,1,0,"tr",10),t.YNc(21,M,1,0,"tr",11),t.qZA(),t._UZ(22,"mat-paginator",12),t.qZA()),2&e&&(t.xp6(1),t.Q6J("dataSource",a.dataSource),t.xp6(19),t.Q6J("matHeaderRowDef",a.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(4,B)))},dependencies:[c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,_.NW,f.uU],styles:[".mat-elevation-z8[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#000;color:#fff}"]});class m{}m.\u0275fac=function(e){return new(e||m)},m.\u0275cmp=t.Xpm({type:m,selectors:[["app-attendance-page"]],decls:1,vars:0,template:function(e,a){1&e&&t._UZ(0,"app-attendance-table")},dependencies:[s]});const L=[{path:"",component:m,data:{title:"attendance"}},{path:"table",component:s,data:{title:"attendance tablee"}}];class r{}r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[u.Bz.forChild(L),u.Bz]});var Q=o(7999);class l{}l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({imports:[f.ez,r,c.p0,_.TU,Q.G]})}}]);