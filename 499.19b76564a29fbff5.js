"use strict";(self.webpackChunkcoreui_free_angular_admin_template=self.webpackChunkcoreui_free_angular_admin_template||[]).push([[499],{1499:($,y,o)=>{o.r(y),o.d(y,{StudentModule:()=>m});var Z=o(6895),T=o(9299),t=o(4650),r=o(4006),g=o(7222),F=o(7613),x=o(7854),A=o(7185),v=o(7579);class d{constructor(){this.studentAddedSource=new v.x,this.studentAdded$=this.studentAddedSource.asObservable()}notifyStudentAdded(){this.studentAddedSource.next()}}function _(s,e){if(1&s&&(t.TgZ(0,"option",19),t._uU(1),t.qZA()),2&s){const n=e.$implicit;t.Q6J("value",n.id),t.xp6(1),t.Oqu(n.name)}}function U(s,e){if(1&s&&(t.TgZ(0,"option",19),t._uU(1),t.qZA()),2&s){const n=e.$implicit;t.Q6J("value",n.id),t.xp6(1),t.Oqu(n.name)}}d.\u0275fac=function(e){return new(e||d)},d.\u0275prov=t.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"});class l{constructor(e,n,i,a,S,C){this.fb=e,this.studentService=n,this.parentService=i,this.shiftService=a,this.toastr=S,this.studentUpdateService=C,this.parents=[],this.shifts=[]}ngOnInit(){this.studentForm=this.fb.group({name:[""],last_name:[""],gender:["",r.kI.required],dni:[""],phone_number:[""],parent:[null],shift:[null]}),this.loadParents(),this.loadShifts()}loadParents(){this.parentService.getParents().subscribe(e=>{this.parents=e.map(n=>({...n,id:Number(n.parent_id)}))})}loadShifts(){this.shiftService.getShifts().subscribe(e=>{this.shifts=e.map(n=>({...n,id:Number(n.shift_id)}))})}onSubmit(){if(this.studentForm.valid){const e={...this.studentForm.value,parent:Number(this.studentForm.value.parent),shift:Number(this.studentForm.value.shift)};console.log("Sending POST with data:",JSON.stringify(e)),this.studentService.addStudent(e).subscribe({next:n=>{this.toastr.success("Student added successfully"),this.studentForm.reset(),this.studentUpdateService.notifyStudentAdded()},error:n=>{this.toastr.error("Failed to add student"),console.error("Error adding student:",n)}})}else this.toastr.error("Please fill all required fields")}}l.\u0275fac=function(e){return new(e||l)(t.Y36(r.qu),t.Y36(g.V),t.Y36(F.H),t.Y36(x.D),t.Y36(A._W),t.Y36(d))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-student-form"]],decls:37,vars:4,consts:[[3,"formGroup","ngSubmit"],["for","name"],["id","name","formControlName","name","type","text"],["for","last_name"],["id","last_name","formControlName","last_name","type","text"],["for","gender"],["formControlName","gender"],["value","M"],["value","F"],["for","dni"],["id","dni","formControlName","dni","type","text"],["for","phone_number"],["id","phone_number","formControlName","phone_number","type","text"],["for","parent"],["id","parent","formControlName","parent"],[3,"value",4,"ngFor","ngForOf"],["for","shift"],["id","shift","formControlName","shift"],["type","submit",3,"disabled"],[3,"value"]],template:function(e,n){1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return n.onSubmit()}),t.TgZ(1,"div")(2,"label",1),t._uU(3,"Name"),t.qZA(),t._UZ(4,"input",2),t.qZA(),t.TgZ(5,"div")(6,"label",3),t._uU(7,"Last Name"),t.qZA(),t._UZ(8,"input",4),t.qZA(),t.TgZ(9,"div")(10,"label",5),t._uU(11,"Gender"),t.qZA(),t.TgZ(12,"select",6)(13,"option",7),t._uU(14,"Male"),t.qZA(),t.TgZ(15,"option",8),t._uU(16,"Female"),t.qZA()()(),t.TgZ(17,"div")(18,"label",9),t._uU(19,"DNI"),t.qZA(),t._UZ(20,"input",10),t.qZA(),t.TgZ(21,"div")(22,"label",11),t._uU(23,"Phone Number"),t.qZA(),t._UZ(24,"input",12),t.qZA(),t.TgZ(25,"div")(26,"label",13),t._uU(27,"Parent"),t.qZA(),t.TgZ(28,"select",14),t.YNc(29,_,2,2,"option",15),t.qZA()(),t.TgZ(30,"div")(31,"label",16),t._uU(32,"Shift"),t.qZA(),t.TgZ(33,"select",17),t.YNc(34,U,2,2,"option",15),t.qZA()(),t.TgZ(35,"button",18),t._uU(36,"Submit"),t.qZA()()),2&e&&(t.Q6J("formGroup",n.studentForm),t.xp6(29),t.Q6J("ngForOf",n.parents),t.xp6(5),t.Q6J("ngForOf",n.shifts),t.xp6(1),t.Q6J("disabled",!n.studentForm.valid))},dependencies:[Z.sg,r._Y,r.YN,r.Kr,r.Fj,r.EJ,r.JJ,r.JL,r.sg,r.u],styles:["form[_ngcontent-%COMP%]{max-width:500px;margin:0 auto;padding:20px;box-shadow:0 0 10px #0000001a;border-radius:8px;background-color:#f9f9f9}div[_ngcontent-%COMP%]{margin-bottom:15px}label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;color:#333;font-weight:700}input[type=text][_ngcontent-%COMP%], select[_ngcontent-%COMP%]{width:100%;padding:8px;border:1px solid #ccc;border-radius:4px;box-sizing:border-box;margin-top:5px}button[type=submit][_ngcontent-%COMP%]{width:100%;padding:10px;border:none;border-radius:4px;background-color:#1a1a1a;color:#fff;font-size:16px;cursor:pointer;transition:background-color .3s ease}button[type=submit][_ngcontent-%COMP%]:hover{background-color:#222}button[type=submit][_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}"]});var O=o(7155),u=o(2722),c=o(5412),N=o(5665),P=o(2642);class h{constructor(e,n,i,a,S,C){this.data=e,this.studentService=n,this.shiftService=i,this.parentService=a,this.dialogRef=S,this.toastr=C,this.title="EDITAR ESTUDIANTE",this.parents=[],this.shifts=[],this.unsubscribe$=new v.x,this.studentFormConfig=[{name:"student_id",label:"ID",type:"number",required:!0,disabled:!0,value:this.data.student.student_id},{name:"name",label:"Nombre",type:"text",required:!0,maxLength:50,value:this.data.student.name},{name:"last_name",label:"Apellido",type:"text",required:!0,maxLength:50,value:this.data.student.last_name},{name:"gender",label:"G\xe9nero",type:"select",required:!0,options:[{value:"M",viewValue:"Masculino"},{value:"F",viewValue:"Femenino"}],value:this.data.student.gender},{name:"dni",label:"DNI",type:"text",required:!0,maxLength:8,value:this.data.student.dni},{name:"phone_number",label:"Tel\xe9fono",type:"text",required:!0,maxLength:15,value:this.data.student.phone_number},{name:"parent",label:"Padre/Madre",type:"select",required:!0,options:this.parents,value:this.data.student.parent},{name:"shift",label:"Turno",type:"select",required:!0,options:this.shifts,value:this.data.student.shift}]}ngOnInit(){this.loadShifts(),this.loadParents()}ngOnDestroy(){this.unsubscribe$.next(null),this.unsubscribe$.complete()}loadShifts(){this.shiftService.getShifts().pipe((0,u.R)(this.unsubscribe$)).subscribe(e=>{this.shifts=e.map(i=>({value:i.shift_id,viewValue:i.name}));const n=this.studentFormConfig.find(i=>"shift"===i.name);n&&(n.options=this.shifts)},e=>{this.toastr.error("Error al cargar los productos")})}loadParents(){this.parentService.getParents().pipe((0,u.R)(this.unsubscribe$)).subscribe(e=>{this.parents=e.map(i=>({value:i.parent_id,viewValue:i.name}));const n=this.studentFormConfig.find(i=>"parent"===i.name);n&&(n.options=this.parents)},e=>{this.toastr.error("Error al cargar los productos")})}onSubmit(e){this.studentService.updateStudent(this.data.student.student_id,e).pipe((0,u.R)(this.unsubscribe$)).subscribe(n=>{this.toastr.success("Estudiante actualizado con \xe9xito","\xc9xito",N.UO),this.dialogRef.close(!0)},n=>{this.toastr.error("Error al actualizar el estudiante","Error",N.gn)})}}h.\u0275fac=function(e){return new(e||h)(t.Y36(c.WI),t.Y36(g.V),t.Y36(x.D),t.Y36(F.H),t.Y36(c.so),t.Y36(A._W))},h.\u0275cmp=t.Xpm({type:h,selectors:[["app-student-edit"]],decls:2,vars:2,consts:[[3,"title","config","submitEvent"]],template:function(e,n){1&e&&(t.TgZ(0,"mat-dialog-content")(1,"app-generic-form",0),t.NdJ("submitEvent",function(a){return n.onSubmit(a)}),t.qZA()()),2&e&&(t.xp6(1),t.Q6J("title",n.title)("config",n.studentFormConfig))},dependencies:[c.xY,P.t]});var Y=o(5045),E=o(6165);class f{constructor(e,n,i,a){this.studentService=e,this.dialog=n,this.crudEventsService=i,this.studentUpdateService=a,this.displayedColumns=["student_id","name","last_name","gender","dni","phone_number","parent","shift"],this.columnNames=["ID","Nombre","Apellido","G\xe9nero","DNI","Tel\xe9fono","parent","shift"],this.unsubscribe$=new v.x,this.dataSource=new O.by([])}ngOnDestroy(){this.unsubscribe$.next(null),this.unsubscribe$.complete()}ngOnInit(){this.updateTableData(),this.crudEventsService.itemAdded.pipe((0,u.R)(this.unsubscribe$)).subscribe(()=>{this.updateTableData()}),this.studentUpdateService.studentAdded$.pipe((0,u.R)(this.unsubscribe$)).subscribe(()=>{this.updateTableData()})}updateTableData(){this.studentService.getStudents().pipe((0,u.R)(this.unsubscribe$)).subscribe(e=>{this.dataSource.data=e})}openEditModal(e){this.dialog.open(h,{data:{student:e}}).afterClosed().pipe((0,u.R)(this.unsubscribe$)).subscribe(i=>{i&&this.updateTableData()})}onDelete(e){}onAdd(){}}f.\u0275fac=function(e){return new(e||f)(t.Y36(g.V),t.Y36(c.uw),t.Y36(Y.Z),t.Y36(d))},f.\u0275cmp=t.Xpm({type:f,selectors:[["app-student-list"]],decls:1,vars:3,consts:[[3,"displayedColumns","columnNames","dataSource","edit","delete","add"]],template:function(e,n){1&e&&(t.TgZ(0,"app-generic-table",0),t.NdJ("edit",function(a){return n.openEditModal(a)})("delete",function(a){return n.onDelete(a)})("add",function(){return n.onAdd()}),t.qZA()),2&e&&t.Q6J("displayedColumns",n.displayedColumns)("columnNames",n.columnNames)("dataSource",n.dataSource)},dependencies:[E.p]});class b{}b.\u0275fac=function(e){return new(e||b)},b.\u0275cmp=t.Xpm({type:b,selectors:[["app-student-page"]],decls:2,vars:0,template:function(e,n){1&e&&t._UZ(0,"app-student-form")(1,"app-student-list")},dependencies:[l,f]});const M=[{path:"",component:b,data:{title:"Student"}},{path:"form",component:l,data:{title:"Student Form"}}];class p{}p.\u0275fac=function(e){return new(e||p)},p.\u0275mod=t.oAB({type:p}),p.\u0275inj=t.cJS({imports:[T.Bz.forChild(M),T.Bz]});var D=o(7999),J=o(939);class m{}m.\u0275fac=function(e){return new(e||m)},m.\u0275mod=t.oAB({type:m}),m.\u0275inj=t.cJS({imports:[Z.ez,p,r.UX,D.G,c.Is,J.W]})}}]);